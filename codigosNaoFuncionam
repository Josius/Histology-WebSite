Os códigos abaixo não funcionam. Precisei deixar eles registrados aqui pq, mesmo comentados, ainda causam erro no html
    
    Código para browse.html
        <!-- 01 - NÃO ESTÁ PASSANDO O ENDEREÇO DA IMAGEM -->
        
                <div class="item">
                    <div class="miniatura">
                        <form action="" method="POST">
                            {{ imgForm.csrf_token }}
                            <button type="submit" value="Submit">
                                <img src="{{url_for('static', filename='imgsMini/L60PeleFinaHE.jpg')}}" alt="" class="imagem" width="60%" height="60%"> 
        
                                <!-- <input id="zImagePath" type="text" name="zImagePath" value="/static/imgsPff/L60PelefinaHE40XB.pff" hidden>  -->
        
                                {{ imgForm.imgUrl(value='imgsPff/L60PelefinaHE40XB.pff') }}
                            </button>
                        </form>
                    </div>
                    <h2>texto</h2>
                    <h3>link</h3>
                </div>
        

<!-- 02 FURUNFOU -->
                        
<div class="item">
    <div class="miniatura">
        <form action="" method="POST">
        
            <button type="submit" value="VALUE1" name="action1">
                <img src="{{url_for('static', filename='imgsMini/L60PeleFinaHE.jpg')}}" alt="" class="imagem" width="60%" height="60%"> 
            </button>
        </form>
    </div>
    <h2>teste 02</h2>
    <h3>link</h3>
</div>



NARRATIVES ORIGINAL    

<article class="narrativa">
        <!-- TENTEI PASSAR A VARIÁVEL imageFile DIRETO PARA A DIV ABAIXO, SEM A VARIÁVEL GLOBAL L60PelefinaHE40XB, MAS NÃO FUNCIONOU -->
        <script>
            //var L60PelefinaHE40XB = {{imageFile}};
            var imagemAtual = "{{url_for('static', filename=imageFile)}}"
        </script>

        <!-- <form id="narrativeDataForm" method="post" action="">
            <input id="zImagePath" name="zImagePath" type="hidden" value="{{url_for('static', filename='imgsPff/L60PelefinaHE40XB.pff')}}">
            <input id="zAnnotationPath" name="zAnnotationPath" type="hidden" value="{{url_for('static', filename='xml/L60PelefinaHE40XB-annotations.xml')}}">
            <input id="zUserName" name="zUserName" type="hidden" value="Guest">
            <input id="zDateTime" name="zDateTime" type="hidden" value="20220223-022400">
        </form> -->

    

<!-- 
        <div><p dir="ltr" style="line-height: 1.38; text-indent: 36pt; margin-top: 0pt; margin-bottom: 0pt; text-align: left;"><span style="text-indent: 36pt; background-color: transparent; font-variant-numeric: normal; font-variant-east-asian: normal; font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); font-weight: 700; vertical-align: baseline; white-space: pre-wrap;">L60- Pele fina</span><span style="text-indent: 36pt; background-color: transparent; font-variant-numeric: normal; font-variant-east-asian: normal; font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap;">&nbsp;</span><br></p><p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">A pele fina cobre a maior parte do corpo, exceto as palmas das mãos e as solas dos pés. Tem uma epiderme relativamente fina (com espessura entre 1 e 2mm) e contém folículos pilosos, glândulas sudoríparas e glândulas sebáceas.</span></p><p><span id="docs-internal-guid-78a0e59f-7fff-ffd3-c057-0af72deefee2"><br></span></p><p>A)&nbsp;<a></a><a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '0', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('0', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)">A epiderme</a>: é formada por epitélio pavimentoso estratificado e tem 5 estratos básicos:</p><p><br></p><p>I-<a></a><a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '1', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('1', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)">Estrato basal</a>: uma camada única de células germinativas com formato cubóide que repousa sobre a membrana basal que está fixada na derme por meio de hemidesmossomos.</p><p>II-&nbsp;<a></a><a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '2', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('2', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)">Estrato espinhoso</a>: camada em que os queratinócitos estão tomando formato mais achatado, devido ao aumento de ligação por desmossomos.</p><p>III-&nbsp;<a></a><a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '3', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('3', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)">Estrato granuloso</a>:&nbsp; queratinócitos começam a apresentar grânulos basofílicos, ricos em queratohialina, no citoplasma.</p><p>IV- Estrato lúcido: apesar de não ser visto em nossa lâmina, é uma zona eletricamente densa</p><p>V-&nbsp;<a></a><a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '4', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('4', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)">Estrato córneo</a>: uma camada rica em queratina, formada também pelas células ,ortas da camada granulosa que liberaram essa mesma queratina.</p><p><br></p><p>B)&nbsp;<a></a><a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '5', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('5', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)">A derme</a>: formada por tecido conectivo denso irregular que dá o suporte a epiderme. Nela se apresentam duas camadas básicas:</p><p><br></p><p>I-&nbsp;<a></a><a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '6', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('6', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)">A camada papilar</a>: região que se projeta até a epiderme</p><p>i-&nbsp;<a></a><a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '6', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('6', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)"></a><a></a><a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '6', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('6', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)"></a><a>As papilas dermais</a>: são projeções da derme em direção as cristas epidermais da epiderme, com o objetivo de aumentar a superfície de contato entre as duas regiões</p><p>ii- Capilares papilar: levam nutrientes até a derme.</p><p><br></p><p>II-&nbsp;<a></a><a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '7', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('7', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)">Camada reticular</a>: rica em tecido conectivo denso e irregular</p><p><br></p><p>III-&nbsp;<a></a><a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '8', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('8', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)">Glândulas sudoríparas écrinas</a>: glândulas de formato tubular espiralado com epitélio cuboidal simples ou estratificado (levemente corado) e células ductais (coloração escura).</p><p><br></p><p>IV- <a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '9', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('9', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)">Folículos pilosos</a>:<span style="background-color: transparent; font-variant-numeric: normal; font-variant-east-asian: normal; font-size: 11pt; font-family: Arial; color: rgb(0, 0, 0); vertical-align: baseline; white-space: pre-wrap;"> estruturas de onde saem os pelos corporais</span></p><p><span style="white-space: pre;">	</span></p><p>C)&nbsp;<a></a><a href="javascript:Z.Viewport.goToLabelByIDAndImage(imagemAtual, '10', null, false, true)" onmouseover="Z.Viewport.setLabelHighlightByDisplayID('10', false, true)" onmouseout="Z.Viewport.clearLabelHighlightsAll(true)">A hipoderme</a>: rica em tecido conectivo e adipócitos.</p></div>
 -->

        <footer>
            <div class="item-d">Guia Histológico {{ current_year }}  |  Versão {{ version }}</div>
        </footer>
        
    </article>

    <!-- 02  CODIGO ORIGINAL-->
    <div class="item">
        <div class="miniatura">
            <form action="" method="POST">
                <button type="submit" value="VALUE2" name="action2">
                    <img src="{{url_for('static', filename='imgsMini/L60PeleFinaHE40XB.jpg')}}" alt="" class="imagem" width="60%" height="60%"> 
                </button>
            </form>
        </div>
        <p>L60PeleFinaHE40XB</p>
        <h3>link</h3>
    </div>


<!-- com request - nao deu certo -->
                    <form method="POST">
                        <input name="imgPath" id="imgPath"  type="hidden" value="imgsPff/L01PeleGrossaCoximdeGatoL2HE40X.pff">
                        <input name="xmlPath" type="hidden" value="xml/L01PeleGrossaCoximdeGatoL2HE40X-annotations.xml">
                        <input name="imgName" type="hidden" value="Pele Grossa">
                        <input name="htmPath" type="hidden" value="static/html/L01PeleGrossaCoximdeGatoL2HE40.htm">
                        <input type="submit" >
                            
                    </form> -->
                    
                    <form method="POST">
                        <input name="text" id="img" type="hidden" value="imgsPff/L01PeleGrossaCoximdeGatoL2HE40X.pff">
                        <input type="submit">
                    </form>
                    <form action="{{ url_for('teste05') }}" method="POST">
                        <a href="./teste05" onclick="enviarDados()">
                            <img src="{{url_for('static', filename='imgsMini/L01PeleGrossaCoximDeGatoL2HE40X.jpg')}}"
                            alt="" width="60%" height="60%">
                        </a>
                        <h6>não deu certo</h6>
                    </form>
<!-- com request - nao deu certo -->

<!-- 04 --> 
            <div class="item">
                <div class="miniatura">
                    <form >                    
                        <a href="./viewportTeste00" onclick="enviarDados()">
                            
                            <img src="{{url_for('static', filename='imgsMini/L01PeleGrossaCoximDeGatoL2HE40X.jpg')}}"
                                alt="" width="60%" height="60%">
                            <input id="imgPath" name="zImagePath" type="hidden"
                                value="imgsPff/L01PeleGrossaCoximdeGatoL2HE40X.pff">
                            <input id="xmlPath" name="zAnnotationPath" type="hidden"
                                value="xml/L01PeleGrossaCoximdeGatoL2HE40X-annotations.xml">
                            <input id="imgName" name="zImageName" type="hidden" value="Pele Grossa">
                            <input id="htmPath" name="zhtmPath" type="hidden"
                                value="static/html/L01PeleGrossaCoximdeGatoL2HE40.htm">

                        </a>
                    </form>
                </div>
                <h2>teste 04</h2>
                <h3>link</h3>
            </div>
            
            <div id="successAlert" class="alert alert-success" role="alert" style="display:none;"></div>
            <div id="errorAlert" class="alert alert-danger" role="alert" style="display:none;"></div>
            <script>
                $(document).ready(function () {
                    $('#submit').click(function () {
                        var formdata = serialize();
                        $.ajax({
                            type: 'POST',
                            contentType: 'application/json',
                            data: JSON.stringify(formdata),
                            dataType: 'json',
                            url: 'http://127.0.0.1:5000/viewportTeste00',
                            success: function (e) {
                                console.log(e);
                                window.location = "http://127.0.0.1:5000/viewportTeste00";
                            },
                            error: function (error) {
                                console.log(error);
                            }
                        });
                    });
                });
            </script>

            
            <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
            <script>
                function myfunction() {
                    const imgUrl = document.getElementById("imgPath").value;
                    const xmlUrl = document.getElementById("xmlPath").value;
                    const imgNome = document.getElementById("imgName").value;
                    const htmlUrl = document.getElementById("htmPath").value;

                    const dict_values = { imgUrl, xmlUrl, imgNome, htmlUrl } //Pass the javascript variables to a dictionary.
                    const s = JSON.stringify(dict_values); // Stringify converts a JavaScript object or value to a JSON string
                    console.log(s); // Prints the variables to console window, which are in the JSON format
                    window.alert(s)
                    $.ajax({
                        url: "/viewportTeste00",
                        type: "POST",
                        contentType: "application/json",
                        data: JSON.stringify(s)
                    });

                }
            </script>

# API
def inserirDados(imgPath, xmlPath, imgName, htmPath):
    return {"imgPath":imgPath, "xmlPath":xmlPath, "imgName":imgName, "htmPath":htmPath}

@backend.route("/selecionaImagem", methods=["POST"])
def selecionaImg():

    body = request.get_json()
    print("Entrou")

    if("imgPath" not in body):
        return geraResponse(400, "O parâmetro é imgPath obrigatório")
    if("xmlPath" not in body):
        return geraResponse(400, "O parâmetro é xmlPath obrigatório")
    if("imgName" not in body):
        return geraResponse(400, "O parâmetro é imgName obrigatório")
    if("htmPath" not in body):
        return geraResponse(400, "O parâmetro é htmPath obrigatório")
    print(body)
    dados = inserirDados(
                        body["imgPath"],
                        body["xmlPath"],
                        body["imgName"],
                        body["htmPath"]
                        )
    
    print(dados)

    return geraResponse(200, "Dados enviados", "dados", dados)

def geraResponse(status, mensagem, nomeDoConteudo=False, conteudo=False):
    response = {}
    response["status"] = status
    response["mensagem"] = mensagem

    if(nomeDoConteudo and conteudo):
        response[nomeDoConteudo] = conteudo

    return response
# API
#  com funcao js
@backend.route('/viewportTeste00', methods=['GET', 'POST'])
def viewportTeste():
    
    # dados_json = request.get_json()
    # dados = jsonify(request.form).json

    dados_json = '{"imgUrl" : "imgsPff/L01PeleGrossaCoximdeGatoL2HE40X.pff", "xmlUrl" : "xml/L01PeleGrossaCoximdeGatoL2HE40X-annotations.xml", "imgNome": "Pele Grossa", "htmlUrl":"static/html/L01PeleGrossaCoximdeGatoL2HE40.htm"}'
    # print(dados_json)
    dados = json.loads(dados_json)
    # # print(dados.dumps())
    

    image = dados["imgUrl"]
    xml = dados["xmlUrl"]
    nmImg = dados["imgNome"]
    arqHtml = open(dados["htmlUrl"], 'r')
    html = arqHtml.read()
    arqHtml.close()

    return render_template(
        'view.html',
        current_year=current_year, current_version=current_version, imageFile=image, xmlFile=xml, htmlFile=html, nomeImagem=nmImg
    )

# 00 com ajax
""" @backend.route('/viewportTeste', methods=['GET', 'POST'])
def viewportTeste():  

    image = request.form['imgUrl']
    xml = request.form["xmlUrl"]
    nmImg = request.form["imgNome"]
    arqHtml = open(request.form["htmlUrl"], 'r')
    html = arqHtml.read()
    arqHtml.close()

    print(image)
    print(type(image))
    return render_template(
        'view.html',
        current_year=current_year, current_version=current_version, imageFile=image, xmlFile=xml, htmlFile=html, nomeImagem=nmImg
    )
 """
    


# 00
# 01 vvv
""" 
@backend.route('/browse', methods=['GET', 'POST'])
def browse():
    imgForm = forms.ImageForm()
    if imgForm.validate_on_submit():
        print(type(imgForm.imgUrl.data))
        print(imgForm.imgUrl.data)
        return viewport(imgForm)
    return render_template('browse.html', page_name='Navegar', current_year=current_year,
                           version=current_version, imgForm = imgForm)
                           

@backend.route('/viewport')
def viewport(imgForm):
    image = imgForm.imgUrl
    return render_template('view.html', current_year=current_year, current_version=current_version, imageFile=image)    
"""
# 01 ^^^


# VIEWPORT ORIGINAL
""" 
@backend.route('/viewport')
def viewport():
    # image = request.form.get('zImagePath')
    return render_template('view.html', current_year=current_year, current_version=current_version, imageFile='imgsPff/L60PelefinaHE40XB.pff')
 """

 # with open('./static/L01PeleGrossaCoximdeGatoL2HE40X.htm') as htmlFile:
#     htmlString = htmlFile.read()

#     @backend.route('/browse')
#     def browse():
#         return render_template('browse.html', page_name='Navegar', current_year=current_year,
#                             version=current_version, imageFile='testeJosimarDois.zif', htmlFile=htmlString, annotationsFile='Assets/Annotations/Narratives/testeJosimarDois-annotations.xml')


# 01 - CÓDIGO ABAIXO NÃO FUNCIONA
""" 
@backend.route('/viewport', methods=['POST'])
def viewport():
    image = request.form.get('zImagePath')
    return render_template('view.html', current_year=current_year, current_version=current_version, imageFile=image)
 """

# 00 - CÓDIGO ABAIXO FUNCIONA
""" 
@backend.route('/viewport')
def viewport():
    image = request.form.get('zImagePath')
    return render_template('view.html', current_year=current_year, current_version=current_version, imageFile='imgsPff/L60PelefinaHE40XB.pff')
"""


""" @backend.route('/viewport')
def viewport():
    return render_template('view.html', current_year=current_year, current_version=current_version,
                           slide_meta=json.load(open('./slides/10/meta.json'))) """
